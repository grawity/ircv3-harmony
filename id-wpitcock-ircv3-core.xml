<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
  <!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
  <!ENTITY RFC5226 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5226.xml">
  <!ENTITY RFC1459 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.1459.xml">
  <!ENTITY RFC2812 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2812.xml">
  <!ENTITY RFC3629 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3629.xml">
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc strict="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="3"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>
<rfc category="std" docName="draft-wpitcock-ircv3-core" obsoletes="1459, 2812">
    <front>
        <title abbrev="IRCv3 Core">Internet Relay Chat Core Protocol version 3</title>
        <author fullname="William Pitcock" initials="W." surname="Pitcock" role="editor">
            <organization>mammon.io</organization>
            <address>
                <email>nenolod@dereferenced.org</email>
                <uri>http://kaniini.dereferenced.org/</uri>
            </address>
        </author>
        <date year="2015" />
        <area>General</area>
        <workgroup>Network Working Group</workgroup>
        <keyword>IRC</keyword>
        <keyword>IRCv3</keyword>
        <keyword>Chat</keyword>
        <abstract>
            <t>The IRC protocol has been developed by the greater IRC user and administrator community since
            the first version formalized in <xref target="RFC1459"/>.  It has adapted over the years to be the
            primary collaboration tool for many groups because of it's simplicity and robustness.</t>

            <t>The IRC Core Protocol version 3 updates <xref target="RFC1459"/> and <xref target="RFC2812"/> with
            a base protocol and framework for extensions which has been developed over the past decade, as well as
            standardizes current known best practices in the greater IRC community.  The IRC Core Protocol version 3
            framework mechanisms also provide some level of compatibility with legacy IRC clients.</t>
        </abstract>
    </front>
    <middle>
        <section title="Requirements Language">
            <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
            "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
            document are to be interpreted as described in <xref target="RFC2119"/>.</t>
        </section>
        <section title="Introduction">
            <t>IRC networks have been maintained over several decades for use with text-based conferencing.
            This document describes the core IRC client protocol and a framework for extending the protocol.</t>

            <t>IRC itself is a distributed teleconferencing and signalling system which is well-suited for running
            on many machines in a distributed manner.  A typical setup involves many clients connecting to an IRC
            server which is connected to other servers in the network.  The IRC server handles all of the necessary
            message routing and broadcast tasks.</t>

            <section title="Servers">
                <t>In a typical IRC network, the servers are linked to each other in a topology which resembles an
                acyclic graph, however, some experimental networks have developed alternative topologies such as
                mesh-like topologies.  Other IRC server software implements support for hot failover connections,
                however this is usually dependent on a specialized server-to-server protocol.</t>
            </section>

            <section title="Clients">
                <t>A client is anything connected to a server which is using the IRC client protocol.  Each client
                is distinguished from other clients by having a unique nickname.  In addition to the nickname, every
                server on the network maintains other information on the client, such as the real hostname of the
                client, the username that the client has selected and other information about the client such as the
                name of the user.</t>

                <section title="IRC Operators">
                    <t>To facilitate maintenance of the network, IRC features a type of privileged user known as an
                    "IRC operator".  IRC operators are granted special privilege to perform maintenance-related tasks
                    such as rerouting servers as needed to mitigate bad network routing.</t>

                    <t>Operators also typically have the ability to enforce network policy by removing users from the
                    network who do not comply with the network's policies.</t>
                </section>
            </section>

            <section title="Channels">
                <t>A channel is a named group of zero or more clients which will all receive messages that
                are addressed to that channel.  The channel is typically created when the first client joins
                it, and typically ceases to exist when the last client leaves it, however some IRC server software
                support keeping the channel open when no clients are presently using it in order to maintain
                the channel's settings.</t>

                <t>Channel names are strings which begin with a configured CHANPREFIX of length up to a
                configured CHANNELLEN length.  Apart from the requirement that the channel name begin with
                a recognized CHANPREFIX, the only other restriction is that may not contain any spaces,
                control codes or commas (&quot;,&quot;) which is used as a list-item separator by the protocol.</t>

                <section title="Channel Statuses">
                    <t>A channel may have zero or more channel operators which provide for the maintenance and
                    moderation of the channel.  Depending on the server software in use, the channel operators may
                    have special sigils as designated by the PREFIX configuration value.</t>

                    <t>In a channel which is moderated, users which are allowed to bypass the moderation are given
                    "voice" status.  Users who have "voice" status MAY be given the &quot;+&quot; sigil to designate
                    that they have the ability to bypass moderation.</t>
                </section>
            </section>

            <section title="Services, Accounts and Authentication">
                <t>A common feature of the present-day IRC networks are the usage of services servers.  These servers
                provide specialized bots which provide an authentication layer on the network, allowing for ownership of
                nicknames and channels.  Services usually provide facilities for account management and authentication,
                and map ownership of objects such as nicknames and channels to those accounts.</t>
            </section>
        </section>
        <section title="The IRC Client Protocol">
            <section title="Overview">
                <t>This protocol is a superset of <xref target="RFC1459" />, and is intended to be backwards compatible with
                <xref target="RFC1459" /> where possible.  It describes only the client side of the protocol unlike <xref target="RFC1459" />,
                as the server protocols have diverged over the years and are no longer compatible.</t>
            </section>
            <section title="Character Encoding">
                <t>While <xref target="RFC1459" /> does not specify any specific character set, servers implementing the IRCv3 core
                protocol SHOULD use UTF-8 as defined by <xref target="RFC3629" />.  Clients SHOULD send UTF-8 unless explicitly configured
                not to do so.</t>

                <t>Because of IRC's scandinavian origin, some IRC servers specify that the characters {}| be mapped to be the lower-case
                equivilants of []\.  This is specified using the CASEMAPPING configuration attribute, and an IRC network MUST use the same
                CASEMAPPING attribute in the entire network.</t>
            </section>
            <section title="Messages">
                <t>Servers and clients send messages between each other which may or may not generate a reply.  If the
                message contains a valid command, as described in later sections, the client SHOULD expect a reply as specified,
                but it is not advised to wait for the reply.  Client to server communications should be treated as asynchronous
                in nature.</t>

                <t>IRC messages consist of up to four parts: the tags section (optional), the prefix (optional), the command and it's
                parameters.  All components of the message are separated using the UTF-8 space character (0x20).</t>

                <t>The presence of a tags section is designated with a single leading &quot;@&quot; symbol (0x40).  The tags section
                consists of a set of key-value pairs delimited by an equals sign (0x3D).  Each key-value pair is delimited by a
                semi-colon (&quot;;&quot;) (0x3B), which may be escaped using a backslash (&quot;\&quot;) (0x5C).  There MUST NOT be
                any whitespace between the &quot;@&quot; symbol and the key-value pairs.</t>

                <t>The presence of a prefix is designated with a single leading colon (&quot;:&quot;) (0x3A).  There MUST NOT be any
                whitespace between the &quot;:&quot; symbol and the prefix itself.  The prefix is used by servers to designate the
                origin of the message.  If the prefix is missing, then clients SHOULD assume it came from the server the client is
                connected to.  Clients SHOULD NOT use the prefix when they are sending a message to a server, but MAY send relevant
                tags.</t>

                <t>The command must be either a valid IRC command or a three-digit number represented in UTF-8 text.</t>

                <t>IRC messages are always lines of characters delimited with a CR-LF (Carriage Return - Line Feed) pair, and these
                messages SHOULD NOT exceed 512 characters in length unless otherwise negotiated with the server as a capability.</t>
            </section>
        </section>
    </middle>
    <back>
        <references title="Normative References">
            &RFC2119;
            &RFC5226;
            &RFC3629;
            &RFC1459;
            &RFC2812;
        </references>
    </back>
</rfc>
